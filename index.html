<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SKEJTY ‚Äî apka na deskƒô | skateboarding app</title>
    <meta name="description" content="Skejty ‚Äî apka dla skat√≥w. Odkrywaj i dodawaj spoty skateboardowe na mapie.">
    <meta name="keywords" content="skejty, apka na deskƒô, apka dla skat√≥w, skejty app, skateboarding app, skate spots, mapa skejt√≥w">
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Roboto+Mono:wght@300;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"> 
    
    <link rel="icon" type="image/png" href="favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="favicon.svg" />
    <link rel="shortcut icon" href="favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png" />
    <meta name="apple-mobile-web-app-title" content="Skejty" />
    <link rel="manifest" href="site.webmanifest" />
    
    <link rel="stylesheet" href="style.css">

</head>
<body class="dark-mode"> <div id="cursor"></div>

    <div id="lightbox" onclick="closeLightbox()">
        <img id="lightbox-img" src="" alt="Full Screen">
    </div>

    <div id="loader">
        <div class="stickman-loader-container">
            <svg class="stickman-svg" viewBox="0 0 200 150" xmlns="http://www.w3.org/2000/svg">
                <!-- Defs for gradients/glows -->
                <defs>
                    <filter id="glow-neon">
                        <feGaussianBlur stdDeviation="2.5" result="coloredBlur"/>
                        <feMerge>
                            <feMergeNode in="coloredBlur"/>
                            <feMergeNode in="SourceGraphic"/>
                        </feMerge>
                    </filter>
                </defs>
                
                <!-- Group for the whole rider + board to bob together -->
                <g class="rider-group">
                    <!-- Skateboard -->
                    <g class="skateboard">
                        <rect x="50" y="110" width="100" height="8" rx="4" fill="var(--neon-blue)" filter="url(#glow-neon)" />
                        <circle class="wheel-spin-svg" cx="70" cy="122" r="8" stroke="var(--neon-pink)" stroke-width="3" fill="none" filter="url(#glow-neon)" />
                        <circle class="wheel-spin-svg" cx="130" cy="122" r="8" stroke="var(--neon-pink)" stroke-width="3" fill="none" filter="url(#glow-neon)" />
                        <!-- Spoke for wheel animation visibility -->
                        <line class="wheel-spoke" x1="70" y1="122" x2="70" y2="114" stroke="var(--neon-pink)" stroke-width="2" />
                        <line class="wheel-spoke" x1="130" y1="122" x2="130" y2="114" stroke="var(--neon-pink)" stroke-width="2" />
                    </g>
                    
                    <!-- Stickman -->
                    <g class="stickman">
                        <!-- Leg on board (Front) -->
                        <line x1="100" y1="80" x2="110" y2="110" stroke="var(--neon-green)" stroke-width="4" stroke-linecap="round" filter="url(#glow-neon)" />
                        <!-- Leg pushing (Back) - Animated -->
                        <line class="leg-push" x1="100" y1="80" x2="70" y2="110" stroke="var(--neon-green)" stroke-width="4" stroke-linecap="round" filter="url(#glow-neon)" />
                        
                        <!-- Body -->
                        <line x1="100" y1="80" x2="95" y2="40" stroke="var(--neon-green)" stroke-width="4" stroke-linecap="round" filter="url(#glow-neon)" />
                        
                        <!-- Arms -->
                        <line class="arm-wave" x1="95" y1="50" x2="125" y2="60" stroke="var(--neon-green)" stroke-width="4" stroke-linecap="round" filter="url(#glow-neon)" />
                        <line class="arm-wave-back" x1="95" y1="50" x2="65" y2="60" stroke="var(--neon-green)" stroke-width="4" stroke-linecap="round" filter="url(#glow-neon)" />
                        
                        <!-- Head -->
                        <circle cx="95" cy="30" r="10" stroke="var(--neon-green)" stroke-width="3" fill="none" filter="url(#glow-neon)" />
                    </g>
                </g>
                
                <!-- Speed lines (Static or Animated) -->
                <line class="speed-line" x1="180" y1="100" x2="220" y2="100" stroke="var(--neon-blue)" stroke-width="2" opacity="0.5" />
                <line class="speed-line" x1="170" y1="120" x2="200" y2="120" stroke="var(--neon-pink)" stroke-width="2" opacity="0.5" />
            </svg>
        </div>
        <h2 style="margin-top: 20px; font-family: 'Orbitron'; animation: pulseText 1.5s infinite alternate;">SKEJTY ≈ÅADOWANIE...</h2>
    </div>

    <div id="notification-container"></div>

    <div class="app-container">
        <div class="sidebar" id="mainSidebar">
            <h1 style="cursor: pointer; transition: text-shadow 0.3s;" onclick="resetMap()" title="Wr√≥ƒá do widoku mapy">SKEJ<span style="color:var(--neon-pink)">TY</span></h1>
            
            <div id="authContent" class="sidebar-section active">
                 <h2 style="margin-bottom: 15px; color: var(--neon-blue);">ZarzƒÖdzanie Kontem</h2>
                 <div id="authSection">
                     <div id="authStatus">≈Åadowanie...</div>
                     <div class="auth-actions">
                         <button class="btn-neon btn-green" id="showLoginBtn" data-hover>Zaloguj</button>
                         <button class="btn-neon btn-orange" id="showRegisterBtn" data-hover>Rejestruj</button>
                         <button class="btn-neon btn-red" id="logoutBtn" style="display:none;" data-hover>Wyloguj</button>
                     </div>
                     
                     <div id="loginForm" style="display:none;">
                        <input type="email" id="loginEmail" class="input-cyber" placeholder="Email" data-hover>
                        <input type="password" id="loginPassword" class="input-cyber" placeholder="Has≈Ço" data-hover>
                        <button class="btn-neon btn-green" onclick="handleLogin()" data-hover>ZALOGUJ SIƒò</button>
                    </div>

                     <div id="registerForm" style="display:none;">
                        <input type="text" id="registerNick" class="input-cyber" placeholder="Tw√≥j Nick/Ksywa" data-hover>
                        <input type="email" id="registerEmail" class="input-cyber" placeholder="Email (np. skater@gmail.com)" data-hover>
                        <input type="password" id="registerPassword" class="input-cyber" placeholder="Has≈Ço (min. 6 znak√≥w)" data-hover>
                        <button class="btn-neon btn-orange" onclick="handleRegister()" data-hover>ZAREJESTRUJ</button>
                    </div>
                     
                     <div id="accountSettings" style="display:none; margin-top: 15px; border-top: 1px dashed var(--neon-blue); padding-top: 15px;">
                        <h3 style="color: var(--neon-pink); margin-bottom: 10px;">Ustawienia konta</h3>
                        <div style="display:flex; gap:10px; align-items:center; margin-bottom:10px;">
                            <input type="text" id="newNickInput" class="input-cyber" placeholder="Nowy nick">
                            <button class="btn-neon btn-blue" id="changeNickBtn">Zmie≈Ñ nick</button>
                        </div>
                        <div style="display:flex; gap:10px; align-items:center;">
                            <input type="password" id="newPasswordInput" class="input-cyber" placeholder="Nowe has≈Ço (min. 6 znak√≥w)">
                            <button class="btn-neon btn-orange" id="changePasswordBtn">Zmie≈Ñ has≈Ço</button>
                        </div>
                        <div id="pwaInstallSection" style="display:none; margin-top: 15px;">
                            <h3 style="color: var(--neon-blue); margin-bottom: 8px;">Dodaj aplikacjƒô na ekran g≈Ç√≥wny</h3>
                            <button class="btn-neon btn-blue" id="installPwaBtn">Zainstaluj aplikacjƒô</button>
                        </div>
                     </div>
                 </div>
            </div>

            <div id="spotsListContent" class="sidebar-section">
                <h2 style="margin-bottom: 15px; color: var(--neon-pink);">Lista Spot√≥w</h2>
                <div id="loginRequiredGlobal" class="login-required" style="display:none;">Musisz siƒô zalogowaƒá!</div>

                 <div id="filterSection" style="margin-top: 0; padding: 15px 0; border-top: 1px dashed var(--neon-blue); border-bottom: 1px dashed var(--neon-blue); margin-bottom: 15px;">
                    <h3 style="color: var(--neon-orange); margin-bottom: 10px;">üîç Filtruj Spoty</h3>
                    
                    <label style="font-size: 0.9rem; font-weight: bold;">Poziom Przypa≈Çu:</label>
                    <select id="filterBust" style="width: 100%; padding: 8px; margin-bottom: 10px; font-family: 'Roboto Mono', monospace;" data-hover>
                        <option value="all">Wszystkie</option>
                        <option value="safe">Bezpiecznie (Chill)</option>
                        <option value="medium">≈öredni (Wbijaj szybko)</option>
                        <option value="high">Du≈ºy (Ochrona goni)</option>
                    </select>

                    <label style="font-size: 0.9rem; font-weight: bold;">Tagi/Elementy:</label>
                    <div class="checkbox-group filter-tags-group" style="display: flex; flex-wrap: wrap; gap: 8px; margin-top: 5px;">
                        <label class="checkbox-item"><input type="checkbox" class="filter-tag" value="Murki"> Murki</label>
                        <label class="checkbox-item"><input type="checkbox" class="filter-tag" value="Rurki"> Rurki</label>
                        <label class="checkbox-item"><input type="checkbox" value="Schody" class="filter-tag"> Schody</label>
                        <label class="checkbox-item"><input type="checkbox" value="Bank" class="filter-tag"> Bank</label>
                        <label class="checkbox-item"><input type="checkbox" value="Flat" class="filter-tag"> Flat</label>
                        <label class="checkbox-item"><input type="checkbox" value="Bowl" class="filter-tag"> Bowl</label>
                        <label class="checkbox-item"><input type="checkbox" value="Inne" class="filter-tag"> Inne</label>
                    </div>
                    <button class="btn-neon btn-blue" id="applyFilterBtn" style="margin-top: 15px;" data-hover>ZASTOSUJ FILTR</button>
                </div>
                <div style="font-family: 'Orbitron'; color: #666; margin: 10px 0; text-align: right;">
                    Liczba spot√≥w: <span id="spotCount" style="color: var(--neon-pink)">0</span>
                </div>
                <div class="spots-list" id="spotsList">
                </div>
            </div>
        </div>
        
        <div id="map-container" class="map-wrapper"> 
            <div id="map" data-hover></div>
            
            <div class="search-overlay">
                <input type="text" id="citySearchInput" class="input-cyber" placeholder="Wpisz miasto / wie≈õ / ulicƒô..." data-hover>
                <button class="search-btn" id="citySearchBtn" data-hover>SZUKAJ</button>
            </div>

            <button class="geo-btn" id="locateUserBtn" title="Znajd≈∫ mnie (GPS)" data-hover>üìç</button>
            
            <div id="loginRequiredFab" class="login-required" style="display:none; position: fixed; bottom: 150px; right: 20px; z-index: 5001; padding: 5px 10px; font-size: 0.8rem; pointer-events: none;">Musisz siƒô zalogowaƒá!</div>
            <div class="fab" id="addSpotFab" data-hover style="display:none;">+</div>
            
            <div id="spot-form" style="display:none; position: fixed; bottom: 150px; right: 20px; z-index: 2000; width: 90%; max-width: 350px; background: var(--form-bg); padding: 15px; border: 2px solid var(--neon-pink); box-shadow: 0 5px 20px rgba(0, 0, 0, 0.6);">
                
                <div class="close-form-btn" onclick="toggleForm(false)" data-hover>&times;</div>
                <div style="font-size: 0.8rem; margin-bottom: 5px; color: var(--neon-orange); display: none;" id="editModeLabel">TRYB EDYCJI</div>
                <input type="text" id="spotName" class="input-cyber" placeholder="Nazwa spota (np. Schody Kina)" data-hover>
                <textarea id="spotDesc" class="textarea-cyber" rows="2" placeholder="Opis nawierzchni..." data-hover></textarea>
                
                <label style="font-size: 0.8rem; font-weight: bold;">Co tam jest?</label>
                <div class="checkbox-group">
                    <label class="checkbox-item"><input type="checkbox" value="Murki" class="spot-tag"> Murki</label>
                    <label class="checkbox-item"><input type="checkbox" value="Rurki" class="spot-tag"> Rurki</label>
                    
                    <label class="checkbox-item"><input type="checkbox" value="Schody" class="spot-tag" id="tagSchody"> Schody</label>
                    <div id="stairsCountContainer" style="display:none; margin-bottom: 10px; background: rgba(0,0,0,0.05); padding: 5px; border-radius: 5px;">
                        <label style="font-size: 0.8rem; font-weight: bold;">Liczba schod√≥w: <span id="stairsValue" style="color:var(--neon-pink)">8</span></label>
                        <input type="range" id="stairsRange" min="1" max="16" value="8">
                    </div>

                    <label class="checkbox-item"><input type="checkbox" value="Bank" class="spot-tag"> Bank</label>
                    <label class="checkbox-item"><input type="checkbox" value="Flat" class="spot-tag"> Flat</label>
                    <label class="checkbox-item"><input type="checkbox" value="Bowl" class="spot-tag"> Bowl</label>
                    
                    <label class="checkbox-item"><input type="checkbox" value="Inne" class="spot-tag" id="tagInne"> Inne</label>
                    <div id="otherInputContainer" style="display:none; margin-bottom: 10px;">
                        <input type="text" id="otherInputValue" class="input-cyber" placeholder="Wpisz co to za element...">
                    </div>
                </div>

                <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                    <div style="flex: 1;">
                        <label style="font-size: 0.8rem; font-weight: bold;">Przypa≈Ç:</label>
                        <select id="spotBust" class="select-cyber" style="margin-bottom: 0;">
                            <option value="safe">Bezpiecznie (Chill)</option>
                            <option value="medium">≈öredni (Wbijaj szybko)</option>
                            <option value="high">Du≈ºy (Ochrona goni)</option>
                        </select>
                    </div>
                    <div style="display: flex; align-items: center;">
                        <label class="checkbox-item" style="height: 42px; margin-top: 18px;">
                            <input type="checkbox" id="spotLights"> üí° Lampy?
                        </label>
                    </div>
                </div>

                <label style="font-size: 0.8rem; font-weight: bold; margin-top: 10px; display: block; color: var(--neon-blue);">Zdjƒôcia spotu (Galeria):</label>
                <div style="font-size: 0.7rem; color: #aaa; margin-bottom: 5px;">Dodaj wiele zdjƒôƒá naraz. Przesuwaj palcem aby zobaczyƒá wszystkie.</div>
                <input type="file" id="galleryUpload" multiple accept="image/*" data-hover>
                <div id="galleryPreviewContainer" style="display: flex; flex-wrap: wrap; gap: 5px; margin-bottom: 10px;"></div>
                <div style="font-size: 0.7rem; color: #888; margin-bottom: 10px;">*Kliknij na mapƒô aby zmieniƒá lokalizacjƒô</div>
                <input type="hidden" id="spotLat">
                <input type="hidden" id="spotLng">
                <button class="btn-neon btn-green" id="saveSpotBtn" data-hover>ZAPISZ NA MAPIE</button>
                <button class="btn-neon btn-orange" id="cancelEditBtn" style="display:none;" data-hover>ANULUJ</button>
            </div>
        </div>
    </div>
    
    <div class="mobile-nav" id="mobileNav">
        <div class="nav-item" id="navKonto" data-target="auth">
            <i class="fas fa-user"></i>
            <span>Konto</span>
        </div>
        <div class="nav-item active" id="navMapa" data-target="map">
            <i class="fas fa-map-location-dot"></i>
            <span>Mapa</span>
        </div>
        <div class="nav-item" id="navSpoty" data-target="spotsList">
            <i class="fas fa-layer-group"></i>
            <span>Spoty</span>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/gsap.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    
    <script src="script.js?v=3"></script>
</body>
</html>
